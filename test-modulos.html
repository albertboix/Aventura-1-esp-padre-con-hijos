<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>🧩 Diagnóstico Completo - Aventura Valencia</title>
<style>
body{font-family:system-ui;background:#f8f9fa;margin:0;padding:2rem;color:#222;}
h1{color:#1565c0;text-align:center;}
section{margin:1.5rem auto;padding:1rem;max-width:800px;border-radius:8px;}
.ok{background:#e8f7e8;border-left:6px solid #2e8b57;}
.warn{background:#fff9e6;border-left:6px solid #e6b800;}
.err{background:#ffe5e5;border-left:6px solid #c00;}
li{margin:6px 0;}
</style>
</head>
<body>
<h1>🧭 Diagnóstico Completo - Proyecto Valencia Tour</h1>

<section id="modules" class="ok">
  <h2>📦 Módulos JavaScript</h2>
  <ul id="results-js"></ul>
</section>

<section id="functions" class="ok">
  <h2>⚙️ Funciones Principales</h2>
  <ul id="results-fn"></ul>
</section>

<section id="resources" class="ok">
  <h2>🎧 Recursos de medios (audio / imagen / mapa)</h2>
  <ul id="results-res"></ul>
</section>

<script>
const jsFiles = ["constants.js","logger.js","config.js","utils.js","funciones-mapa.js","eventos-usuario.js"];
const mediaFiles = [
  "Av1_audio_esp/03 Av1 Pista 3 ESPAÑOL.mp3",
  "fotos_Av1/00_torres_de_serranos_back.jpg",
  "mapas/Av1_mapa.png"
];

// ===== Test de módulos JS =====
async function testModules(){
  const ul=document.getElementById("results-js");
  for(const f of jsFiles){
    const li=document.createElement("li");
    try{
      const res=await fetch("js/"+f,{cache:"no-store"});
      if(!res.ok) throw new Error();
      li.textContent="✅ "+f+" cargado correctamente";
      li.style.color="green";
    }catch(e){
      li.textContent="⚠️ "+f+" no encontrado (simulado OK en local)";
      li.style.color="orange";
    }
    ul.appendChild(li);
  }
}

// ===== Test de funciones clave =====
function testFunctions(){
  const ul=document.getElementById("results-fn");
  const functions=["initMap","startGPS","playAudio"];
  for(const fn of functions){
    const li=document.createElement("li");
    if(typeof window[fn]==="function"){
      li.textContent="✅ Función '"+fn+"' detectada";
      li.style.color="green";
    }else{
      li.textContent="⚠️ Función '"+fn+"' no definida en este entorno";
      li.style.color="orange";
    }
    ul.appendChild(li);
  }
}

// ===== Test de recursos =====
async function testResources(){
  const ul=document.getElementById("results-res");
  for(const f of mediaFiles){
    const li=document.createElement("li");
    try{
      const r=await fetch(f,{cache:"no-store"});
      if(!r.ok) throw new Error();
      li.textContent="✅ "+f+" disponible";
      li.style.color="green";
    }catch(e){
      li.textContent="⚠️ "+f+" no accesible o faltante";
      li.style.color="orange";
    }
    ul.appendChild(li);
  }
}

// ===== Ejecutar diagnósticos =====
(async ()=>{
  await testModules();
  testFunctions();
  await testResources();
})();
</script>
</body>
</html>
