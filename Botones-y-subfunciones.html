<!DOCTYPE html>
<html lang="es">
<body>
  <!-- Botones principales flotantes -->
  <button id="hamburguesa" class="boton-flotante" style="pointer-events:auto;">☰</button>
  <button id="mas-opciones" class="boton-flotante" style="pointer-events:auto;">⋮</button>
  <button id="btn-mapa" class="boton-flotante" style="pointer-events:auto;">🌍</button>

  <!-- Iconos hijos flotantes (se muestran al pulsar un botón principal) -->
  <button class="icono-flotante" id="icono-retos" style="pointer-events:auto;">🧩</button>
  <button class="icono-flotante" id="icono-gastronomia" style="pointer-events:auto;">🍽️</button>
  <button class="icono-flotante" id="icono-informacion" style="pointer-events:auto;">🌐</button>
  <button class="icono-flotante" id="icono-historia" style="pointer-events:auto;">🏛️</button>
  <button class="icono-flotante" id="icono-agradecimientos" style="pointer-events:auto;">🤝</button>
  <button class="icono-flotante" id="icono-seguridad" style="pointer-events:auto;">🚦</button>
  <button class="icono-flotante" id="icono-fuentes" style="pointer-events:auto;">📚</button>
  <button class="icono-flotante" id="icono-punto" style="pointer-events:auto;">📍</button>
  <button class="icono-flotante" id="icono-ruta" style="pointer-events:auto;">🗺️</button>
  <button class="icono-flotante" id="icono-brujula" style="pointer-events:auto;">🧭</button>

  <style>
    .boton-flotante, .icono-flotante {
      position: fixed;
      background: #007acc;
      color: white;
      border-radius: 50%;
      width: 56px;
      height: 56px;
      font-size: 2rem;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
      user-select: none;
      z-index: 3300 !important;
      pointer-events: auto;
      border: none;
      outline: none;
      line-height: 1;
      padding: 0;
    }
    .icono-flotante {
      width: 44px;
      height: 44px;
      font-size: 1.5rem;
      z-index: 3300 !important;
      transition: opacity 0.3s ease;
      pointer-events: auto;
      display: none;
      opacity: 0;
      visibility: hidden;
      left: unset !important;
      top: unset !important;
    }
    #hamburguesa { bottom: 75px; left: 12px; }
    #mas-opciones { bottom: 75px; right: 12px; }
    #btn-mapa { top: 12px; right: 12px; }
  </style>

  <script>
    // --- Configuración de los grupos de iconos hijos por cada botón principal ---
    const gruposIconos = {
      hamburguesa: ['icono-retos','icono-gastronomia','icono-informacion','icono-historia'],
      'mas-opciones': ['icono-agradecimientos','icono-seguridad','icono-fuentes'],
      'btn-mapa': ['icono-punto','icono-ruta','icono-brujula']
    };

    // --- Enlaces asociados a cada icono hijo (null si no hay enlace) ---
    const enlacesIconos = {
      'icono-retos': 'retos_con_puzzles_Av1_es.html',
      'icono-gastronomia': 'Gastronomia.html',
      'icono-informacion': 'paginas_oficiales.html',
      'icono-historia': 'enlaces_valencia_historica.html',
      'icono-agradecimientos': 'Agradecimientos.html',
      'icono-seguridad': 'consejos_seguridad_vial.html',
      'icono-fuentes': null,
      'icono-punto': null,
      'icono-ruta': 'Av1_mapa_completo.html',
      'icono-brujula': 'mapas/Av1_mapa.jpg'
    };

    // --- Oculta todos los iconos hijos ---
    function ocultarTodos() {
      Object.values(gruposIconos).flat().forEach(id => {
        const el = document.getElementById(id);
        if (el) {
          el.style.display = 'none';
          el.style.visibility = 'hidden';
          el.style.opacity = 0;
        }
      });
    }

    // --- Muestra los iconos hijos del grupo correspondiente ---
    function mostrarGrupo(botonId) {
      if (!gruposIconos[botonId]) return;
      gruposIconos[botonId].forEach(id => {
        const el = document.getElementById(id);
        if (el) {
          el.style.display = 'flex';
          el.style.visibility = 'visible';
          el.style.opacity = 1;
        }
      });
    }

    // --- Inicializa los eventos de los botones principales e iconos hijos ---
    function inicializarBotonesFlotantes() {
      // Botones principales
      Object.keys(gruposIconos).forEach(botonId => {
        const boton = document.getElementById(botonId);
        if (!boton) return;
        boton.addEventListener('click', function(e) {
          ocultarTodos();
          mostrarGrupo(botonId);
          window.parent.postMessage({ type: 'pauseAudioFromBoton' }, '*');
          e.stopPropagation();
        });
      });

      // Iconos hijos
      Object.entries(enlacesIconos).forEach(([id, url]) => {
        const el = document.getElementById(id);
        if (!el) return;
        el.addEventListener('click', function(e) {
          ocultarTodos();
          window.parent.postMessage({ type: 'pauseAudioFromBoton' }, '*');
          if (url) window.open(url, '_blank');
          e.stopPropagation();
        });
      });

      // Oculta todos los iconos al cargar
      ocultarTodos();

      // Oculta iconos si haces click fuera
      document.body.addEventListener('click', ocultarTodos);
    }

    window.addEventListener('DOMContentLoaded', inicializarBotonesFlotantes);
  </script>
</body>
</html>
