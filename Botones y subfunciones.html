<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Botones y Subfunciones</title>
  <style>
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      overflow-x: hidden;
      overflow-y: hidden;
    }
    .boton-flotante, .icono-flotante {
      position: fixed;
      background: #007acc;
      color: white;
      border-radius: 50%;
      width: 56px;
      height: 56px;
      font-size: 2.4rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
      user-select: none;
      z-index: 12000;
      transition: background-color 0.3s;
    }
    .boton-flotante:hover,
    .icono-flotante:hover {
      background-color: #005f99;
    }
    #hamburguesa { bottom: 12px; left: 12px; }
    #mas-opciones { bottom: 12px; right: 12px; }
    #btn-mapa { top: 12px; right: 12px; }

    .icono-flotante {
      width: 45px;
      height: 45px;
      font-size: 1.8rem;
      z-index: 13000;
      position: fixed;
      display: none;
    }
  </style>
</head>
<body>
  <!-- Botones principales -->
  <button id="hamburguesa" class="boton-flotante">☰</button>
  <button id="mas-opciones" class="boton-flotante">⋮</button>
  <button id="btn-mapa" class="boton-flotante">🌍</button>

  <!-- Iconos flotantes -->
  <button class="icono-flotante" id="icono-retos">🧩</button>
  <button class="icono-flotante" id="icono-gastronomia">🍽️</button>
  <button class="icono-flotante" id="icono-informacion">🌐</button>
  <button class="icono-flotante" id="icono-historia">🏛️</button>
  <button class="icono-flotante" id="icono-agradecimientos">🤝</button>
  <button class="icono-flotante" id="icono-seguridad">🚦</button>
  <button class="icono-flotante" id="icono-fuentes">📚</button>
  <button class="icono-flotante" id="icono-punto">📍</button>
  <button class="icono-flotante" id="icono-ruta">🗺️</button>
  <button class="icono-flotante" id="icono-brujula">🧭</button>

  <script>
    const gruposIconos = {
      hamburguesa: ['icono-retos','icono-gastronomia','icono-informacion','icono-historia'],
      'mas-opciones': ['icono-agradecimientos','icono-seguridad','icono-fuentes'],
      'btn-mapa': ['icono-punto','icono-ruta','icono-brujula']
    };

    // Ángulos para disposición radial según icono padre (en grados)
    // Los ajustamos según tu pedido: hamburguesa (4 iconos) 12, 1, 2, 3 horas
    // mas-opciones (3 iconos) 12, 10:30, 9
    // btn-mapa (3 iconos) 9, 7:30, 6
    const angulos = {
      hamburguesa: [270, 300, 330, 0], // 12h=270°, 1h=300°, 2h=330°, 3h=0°
      'mas-opciones': [270, 225, 180], // 12h=270°, 10:30=225°, 9h=180°
      'btn-mapa': [180, 225, 270] // 9h=180°, 7:30=225°, 6h=270° (ajustados para que estén abajo-izq)
    };

    let iconosMostradosPor = null; // para saber qué menú está abierto

    function ocultarTodosLosIconos() {
      Object.values(gruposIconos).flat().forEach(id => {
        const el = document.getElementById(id);
        if (el) el.style.display = 'none';
      });
      iconosMostradosPor = null;
    }

    function posicionarIconosRadial(iconos, boton, angulosDeg, radio = 100) {
      const rect = boton.getBoundingClientRect();
      const cx = rect.left + rect.width / 2;
      const cy = rect.top + rect.height / 2;
      const margen = 8;

      iconos.forEach((icono, index) => {
        icono.style.display = 'flex';
        const a = angulosDeg[index] * Math.PI / 180;
        // Ajuste para que no salgan fuera de la pantalla
        const x = Math.min(
          window.innerWidth - icono.offsetWidth - margen,
          Math.max(margen, cx + radio * Math.cos(a) - icono.offsetWidth / 2)
        );
        const y = Math.min(
          window.innerHeight - icono.offsetHeight - margen,
          Math.max(margen, cy + radio * Math.sin(a) - icono.offsetHeight / 2)
        );
        icono.style.left = `${x}px`;
        icono.style.top = `${y}px`;
        // console.log(`[${icono.id}] → x:${x}, y:${y}`);
      });
      iconosMostradosPor = boton.id;
    }

    // Función para mostrar los iconos flotantes de un botón padre, global para que padre lo llame
    window.mostrarIconosDeBoton = function(botonId) {
      if (!gruposIconos[botonId]) return;
      const boton = document.getElementById(botonId);
      if (!boton) return;

      const iconos = gruposIconos[botonId].map(id => document.getElementById(id));
      const estanMostrados = iconos.every(icono => icono.style.display === 'flex');
      if (estanMostrados) {
        ocultarTodosLosIconos();
      } else {
        ocultarTodosLosIconos();
        posicionarIconosRadial(iconos, boton, angulos[botonId]);
      }
    };

    // Evento click para cada botón principal
    Object.entries(gruposIconos).forEach(([botonId, iconoIds]) => {
      const boton = document.getElementById(botonId);
      if (!boton) return;
      boton.onclick = () => {
        window.mostrarIconosDeBoton(botonId);
      };
    });

    // Reposicionar iconos si cambian tamaño o orientación
    window.addEventListener('resize', () => {
      if (iconosMostradosPor) {
        const botonId = iconosMostradosPor;
        const boton = document.getElementById(botonId);
        if (!boton) return;
        const iconos = gruposIconos[botonId].map(id => document.getElementById(id));
        posicionarIconosRadial(iconos, boton, angulos[botonId]);
      }
    });

    // Asignar redirecciones directas para los iconos
    document.getElementById('icono-retos').onclick = () => window.location.href = 'retos_con_puzzles_Av1_es.html';
    document.getElementById('icono-gastronomia').onclick = () => window.location.href = 'Gastronomia.html';
    document.getElementById('icono-informacion').onclick = () => window.location.href = 'paginas_oficiales.html';
    document.getElementById('icono-historia').onclick = () => window.location.href = 'enlaces_valencia_historica.html';
    document.getElementById('icono-agradecimientos').onclick = () => window.location.href = 'Agradecimientos.html';
    document.getElementById('icono-seguridad').onclick = () => window.location.href = 'consejos_seguridad_vial.html';
    document.getElementById('icono-fuentes').onclick = () => window.location.href = 'fuentes.html';
    document.getElementById('icono-punto').onclick = () => alert('Función "Punto" aún no definida');
    document.getElementById('icono-ruta').onclick = () => window.location.href = 'Av1_mapa_completo.html';
    document.getElementById('icono-brujula').onclick = () => window.location.href = 'mapas/Av1_mapa.jpg';

  </script>
</body>
</html>
