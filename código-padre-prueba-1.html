<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>App Padre Mejorada</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: Arial, sans-serif;
      overflow: hidden;
      background: #f0f0f0;
    }
    #mapa {
      height: 100vh;
      width: 100vw;
      z-index: 1;
    }
    .boton-flotante {
      position: fixed;
      background: #007acc;
      color: white;
      border: none;
      border-radius: 50%;
      width: 56px;
      height: 56px;
      font-size: 2.4rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
      z-index: 12000;
    }
    .icono-flotante {
      position: fixed;
      background: #007acc;
      color: white;
      border-radius: 50%;
      width: 45px;
      height: 45px;
      font-size: 1.8rem;
      display: none;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      z-index: 13000;
      transition: background-color 0.3s;
    }
    .icono-flotante:hover {
      background-color: #005f99;
    }
  </style>
</head>
<body>
  <div id="mapa"></div>

  <button id="hamburguesa" class="boton-flotante" style="bottom: 12px; left: 12px;">☰</button>
  <button id="mas-opciones" class="boton-flotante" style="bottom: 12px; right: 12px;">⋮</button>
  <button id="btn-mapa" class="boton-flotante" style="top: 12px; right: 12px;">🌍</button>

  <!-- Iconos secundarios -->
  <button id="icono-retos" class="icono-flotante">🧩</button>
  <button id="icono-gastronomia" class="icono-flotante">🍽️</button>
  <button id="icono-informacion" class="icono-flotante">🌐</button>
  <button id="icono-historia" class="icono-flotante">🏛️</button>
  <button id="icono-agradecimientos" class="icono-flotante">🤝</button>
  <button id="icono-seguridad" class="icono-flotante">🚦</button>
  <button id="icono-fuentes" class="icono-flotante">📚</button>
  <button id="icono-punto" class="icono-flotante">📍</button>
  <button id="icono-ruta" class="icono-flotante">🗺️</button>
  <button id="icono-brujula" class="icono-flotante">🧭</button>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const iconosUrls = {
      'icono-retos': 'retos_con_puzzles_Av1_es.html',
      'icono-gastronomia': 'Gastronomia.html',
      'icono-informacion': 'paginas_oficiales.html',
      'icono-historia': 'enlaces_valencia_historica.html',
      'icono-agradecimientos': 'Agradecimientos.html',
      'icono-seguridad': 'consejos_seguridad_vial.html',
      'icono-fuentes': null
    };

    const gruposIconos = {
      'hamburguesa': ['icono-retos','icono-gastronomia','icono-informacion','icono-historia'],
      'mas-opciones': ['icono-agradecimientos','icono-seguridad','icono-fuentes'],
      'btn-mapa': ['icono-punto','icono-ruta','icono-brujula']
    };

    function cerrarTodo() {
      Object.values(gruposIconos).flat().forEach(id => {
        document.getElementById(id).style.display = 'none';
      });
    }

    function posicionarIconosRadial(iconos, boton, angulosDeg, radio = 60) {
      const rect = boton.getBoundingClientRect();
      const cx = rect.left + rect.width / 2;
      const cy = rect.top + rect.height / 2;

      iconos.forEach((icono, i) => {
        icono.style.display = 'flex';
        const a = angulosDeg[i] * Math.PI / 180;
        icono.style.left = (cx + radio * Math.cos(a) - icono.offsetWidth / 2) + 'px';
        icono.style.top = (cy + radio * Math.sin(a) - icono.offsetHeight / 2) + 'px';
      });
    }

    Object.entries(gruposIconos).forEach(([botonId, iconoIds]) => {
      const boton = document.getElementById(botonId);
      boton.addEventListener('click', () => {
        const iconos = iconoIds.map(id => document.getElementById(id));
        const algunoVisible = iconos.some(icono => icono.style.display === 'flex');
        cerrarTodo();
        if (!algunoVisible) {
          const angulos = {
            'hamburguesa': [270, 300, 330, 0],
            'mas-opciones': [270, 225, 180],
            'btn-mapa': [180, 135, 90]
          };
          posicionarIconosRadial(iconos, boton, angulos[botonId]);
        }
      });
    });

    Object.keys(iconosUrls).forEach(id => {
      const icono = document.getElementById(id);
      if (!icono) return;
      icono.addEventListener('click', () => {
        const url = iconosUrls[id];
        cerrarTodo();
        if (url) {
          window.open(url, '_blank');
        }
      });
    });
  </script>
</body>
</html>
