<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>App Padre Mejorada</title>
  <link
    rel="stylesheet"
    href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
  />
  <style>
    body, html {
      margin: 0;
      padding: 0;
      height: 100%;
      font-family: Arial, sans-serif;
      overflow: hidden;
    }
    #mapa {
      height: 100vh;
      width: 100vw;
    }

    .boton-flotante, .boton-flotante-grande {
      position: fixed;
      background: #007acc;
      color: white;
      border: none;
      border-radius: 50%;
      width: 56px;
      height: 56px;
      font-size: 2.4rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
      user-select: none;
      z-index: 12000;
    }

    #hamburguesa {
      bottom: 15px;
      left: 15px;
    }

    #mas-opciones {
      bottom: 15px;
      right: 15px;
    }

    #btn-mapa {
      top: 15px;
      right: 15px;
    }

    #gps-prueba {
      position: fixed;
      top: 15px;
      left: 15px;
      z-index: 13000;
      width: 130px;
      height: 40px;
      font-size: 1rem;
      border-radius: 6px;
      text-align: center;
      background: green;
      color: white;
      cursor: pointer;
      user-select: none;
    }

    .submenu-panel {
      position: fixed;
      background: transparent;
      z-index: 12500;
      display: none;
      flex-direction: column;
      gap: 12px;
    }

    .submenu-panel button {
      background: #e0e0e0;
      color: #007acc;
      border: none;
      padding: 10px 15px;
      font-size: 1.1rem;
      border-radius: 8px;
      cursor: pointer;
      text-align: left;
    }

    .submenu-panel button:hover {
      background: #d0d0d0;
    }

    #submenu-hamburguesa {
      bottom: 80px;
      left: 15px;
    }

    #submenu-trespuntos {
      bottom: 80px;
      right: 15px;
    }

    #submenu-mapa {
      top: 80px;
      right: 15px;
      align-items: flex-end;
    }

    #submenu-mapa button {
      width: 56px;
      height: 56px;
      border-radius: 50%;
      font-size: 1.4rem;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #iframe-panel {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: white;
      z-index: 14000;
      display: none;
      flex-direction: column;
    }

    #iframe-panel iframe {
      flex-grow: 1;
      border: none;
    }

    #cerrar-iframe {
      position: absolute;
      top: 10px;
      right: 10px;
      background: blue;
      color: orange;
      font-size: 1.2rem;
      font-weight: bold;
      padding: 8px 12px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      z-index: 15000;
    }

    #imagen-full {
      position: fixed;
      top: 0.5vh;
      left: 0.5vw;
      width: 99vw;
      height: 99vh;
      background: white;
      border-radius: 10px;
      box-shadow: 0 0 25px rgba(0,0,0,0.5);
      z-index: 14000;
      display: none;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    #imagen-full img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <div id="mapa"></div>
  <iframe id="hijo" src="Av1-coordenadas.html" style="width:0; height:0; border:none; position:absolute; z-index:-1;"></iframe>
  <button id="hamburguesa" class="boton-flotante">‚ò∞</button>
  <button id="mas-opciones" class="boton-flotante">‚ãÆ</button>
  <button id="btn-mapa" class="boton-flotante">üåç</button>
  <button id="gps-prueba">GPS Prueba Casa</button>

  <div id="submenu-hamburguesa" class="submenu-panel">
    <button onclick="abrirIframe('retos_con_puzzles_Av1_es.html')">Retos</button>
    <button onclick="abrirIframe('Gastronomia.html')">Gastronom√≠a</button>
    <button onclick="abrirIframe('paginas_oficiales.html')">Oficiales</button>
    <button onclick="abrirIframe('enlaces_valencia_historica.html')">Hist√≥rica</button>
  </div>

  <div id="submenu-trespuntos" class="submenu-panel">
    <button onclick="abrirIframe('Agradecimientos.html')">Agradecimientos</button>
    <button onclick="abrirIframe('consejos_seguridad_vial.html')">Seguridad</button>
    <button disabled>Fuentes</button>
  </div>

  <div id="submenu-mapa" class="submenu-panel">
    <button onclick="document.getElementById('hijo').contentWindow.postMessage({ tipo: 'mostrar_siguiente' }, '*')">üìç</button>
    <button onclick="document.getElementById('hijo').contentWindow.postMessage({ tipo: 'mostrar_ruta' }, '*')">üó∫Ô∏è</button>
    <button onclick="mostrarImagen()">üß≠</button>
  </div>

  <div id="iframe-panel">
    <button id="cerrar-iframe" onclick="cerrarIframe()">X</button>
    <iframe src=""></iframe>
  </div>

  <div id="imagen-full">
    <img src="mapas/Av1_mapa.jpg" alt="Mapa completo" />
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const mapa = L.map('mapa').setView([39.4699, -0.3763], 14);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', { maxZoom: 19 }).addTo(mapa);

    const submenuHamburguesa = document.getElementById('submenu-hamburguesa');
    const submenuTrespuntos = document.getElementById('submenu-trespuntos');
    const submenuMapa = document.getElementById('submenu-mapa');

    function cerrarTodosSubmenus() {
      submenuHamburguesa.style.display = 'none';
      submenuTrespuntos.style.display = 'none';
      submenuMapa.style.display = 'none';
    }

    document.getElementById('hamburguesa').onclick = () => {
      const visible = submenuHamburguesa.style.display === 'flex';
      cerrarTodosSubmenus();
      submenuHamburguesa.style.display = visible ? 'none' : 'flex';
    };

    document.getElementById('mas-opciones').onclick = () => {
      const visible = submenuTrespuntos.style.display === 'flex';
      cerrarTodosSubmenus();
      submenuTrespuntos.style.display = visible ? 'none' : 'flex';
    };

    document.getElementById('btn-mapa').onclick = () => {
      const visible = submenuMapa.style.display === 'flex';
      cerrarTodosSubmenus();
      submenuMapa.style.display = visible ? 'none' : 'flex';
    };

    function mostrarImagen() {
      cerrarTodosSubmenus();
      document.getElementById('imagen-full').style.display = 'flex';
    }

    function abrirIframe(url) {
      cerrarTodosSubmenus();
      document.querySelector('#iframe-panel iframe').src = url;
      document.getElementById('iframe-panel').style.display = 'flex';
    }

    function cerrarIframe() {
      document.getElementById('iframe-panel').style.display = 'none';
      document.querySelector('#iframe-panel iframe').src = '';
    }
  </script>
</body>
</html>
