<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
<title>App Aventura - Padre</title>
<style>
  /* Estilos generales */
  body.no-interactivo *:not(#modal-terminos):not(#modal-terminos *) {
    pointer-events: none;
    user-select: none;
  }
  body {
    margin:0; font-family: Arial, sans-serif;
  }

  /* Botones flotantes grandes y posicionados */
  .boton-flotante {
    position: fixed;
    background-color: #0078d7;
    color: white;
    border-radius: 12px;
    cursor: pointer;
    user-select: none;
    font-size: 36px; /* Iconos más grandes */
    width: 64px;
    height: 64px;
    line-height: 64px;
    text-align: center;
    box-shadow: 0 3px 6px rgba(0,0,0,0.3);
    transition: background-color 0.3s ease;
    z-index: 1000;
  }
  .boton-flotante:hover {
    background-color: #005fa3;
  }

  /* Posiciones */
  #btn-hamburguesa {
    bottom: 16px;
    left: 16px;
  }
  #btn-tres-puntos {
    bottom: 16px;
    right: 16px;
  }
  #btn-mapa {
    top: 16px;
    right: 16px;
  }
  #btn-prueba-casa {
    top: 16px;
    left: 16px;
    background-color: #d32f2f;
    font-size: 20px;
    width: auto;
    padding: 0 14px;
    border-radius: 20px;
    line-height: 64px;
    user-select: none;
    z-index: 1100;
  }

  /* Submenús */
  .submenu {
    position: fixed;
    background: white;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.25);
    display: none;
    z-index: 1500;
    flex-direction: column;
  }
  .submenu button {
    display: flex;
    align-items: center;
    font-size: 24px; /* Más grande */
    padding: 16px 28px;
    border: none;
    background: none;
    width: 240px;
    cursor: pointer;
    border-bottom: 1px solid #ddd;
    color: #222;
    transition: background-color 0.3s ease;
  }
  .submenu button:last-child {
    border-bottom: none;
  }
  .submenu button:hover {
    background-color: #0078d7;
    color: white;
  }

  /* Animaciones hamburguesa y tres puntos: sube desde el botón */
  #submenu-hamburguesa {
    bottom: 88px;
    left: 16px;
    animation: slideUp 0.3s ease forwards;
  }
  #submenu-tres-puntos {
    bottom: 88px;
    right: 16px;
    animation: slideUp 0.3s ease forwards;
  }

  @keyframes slideUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Animaciones para el menú de mapa: baja desde el botón */
  #submenu-mapa {
    top: 88px;
    right: 16px;
    width: 240px;
    animation: slideDown 0.3s ease forwards;
  }
  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Pestaña pantalla completa para iframes y modales */
  #pantalla-completa {
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.85);
    display: none;
    justify-content: center;
    align-items: center;
    flex-direction: column;
    z-index: 2000;
  }
  #iframe-contenido {
    width: 95%;
    height: 95%;
    border: none;
    border-radius: 12px;
    box-shadow: 0 0 20px rgba(0,0,0,0.7);
  }
  #cerrar-pantalla {
    position: absolute;
    top: 16px;
    right: 16px;
    font-size: 36px;
    background: transparent;
    border: none;
    color: white;
    cursor: pointer;
    user-select: none;
    z-index: 2100;
  }

  /* Modal términos y condiciones pantalla completa */
  #modal-terminos {
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    background: rgba(0,0,0,0.95);
    z-index: 3000;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  #modal-contenido {
    background: white;
    width: 90%;
    max-width: 600px;
    max-height: 80vh;
    overflow-y: auto;
    border-radius: 12px;
    padding: 20px;
    box-sizing: border-box;
  }
  #modal-contenido iframe {
    width: 100%;
    height: 60vh;
    border: none;
    margin-bottom: 20px;
  }
  #btn-aceptar-terminos {
    background-color: #0078d7;
    color: white;
    border: none;
    padding: 14px 24px;
    border-radius: 8px;
    font-size: 20px;
    cursor: pointer;
    user-select: none;
    display: block;
    margin: 0 auto;
  }

</style>
</head>
<body class="no-interactivo">

<!-- Botón prueba casa toggle -->
<div id="btn-prueba-casa" class="boton-flotante" title="Prueba Casa: OFF">Prueba Casa OFF</div>

<!-- Botones flotantes -->
<div id="btn-hamburguesa" class="boton-flotante" title="Menú">&#9776;</div>
<div id="btn-tres-puntos" class="boton-flotante" title="Opciones">&#8942;</div>
<div id="btn-mapa" class="boton-flotante" title="Mapa">&#128506;</div>

<!-- Submenús -->
<div id="submenu-hamburguesa" class="submenu" style="display:none;">
  <button data-url="retos_con_puzzles_Av1_es.html">Retos y Puzzles</button>
  <button data-url="Gastronomia.html">Gastronomía</button>
  <button data-url="paginas_oficiales.html">Páginas Oficiales</button>
  <button data-url="enlaces_valencia_historica.html">València Histórica</button>
</div>

<div id="submenu-tres-puntos" class="submenu" style="display:none;">
  <button data-url="Agradecimientos.html">Agradecimientos</button>
  <button data-url="consejos_seguridad_vial.html">Consejos Seguridad Vial</button>
  <button data-url="fuentes_informacion.html">Fuentes (En desarrollo)</button>
</div>

<div id="submenu-mapa" class="submenu" style="display:none;">
  <button title="Coordenadas" data-url="Av1-coordenadas.html">&#128506; Coordenadas</button>
  <button title="Ruta completa" data-url="Av1-ruta-completa.html">&#128506; Ruta Completa</button>
  <button title="Mapa tradicional" data-url="mapas/Av1_mapa.html">&#128441; Mapa Tradicional</button>
</div>

<!-- Pestaña pantalla completa -->
<div id="pantalla-completa" style="display:none;">
  <button id="cerrar-pantalla" title="Cerrar">✕</button>
  <iframe id="iframe-contenido" src="" allow="geolocation; autoplay" allowfullscreen></iframe>
</div>

<!-- Modal términos y condiciones -->
<div id="modal-terminos" style="display:none;">
  <div id="modal-contenido">
    <iframe src="terminos_y_condiciones.html"></iframe>
    <button id="btn-aceptar-terminos">Acepto los Términos y Condiciones</button>
  </div>
</div>

<script>
  // Variables
  const btnHamburguesa = document.getElementById('btn-hamburguesa');
  const btnTresPuntos = document.getElementById('btn-tres-puntos');
  const btnMapa = document.getElementById('btn-mapa');
  const submenuHamburguesa = document.getElementById('submenu-hamburguesa');
  const submenuTresPuntos = document.getElementById('submenu-tres-puntos');
  const submenuMapa = document.getElementById('submenu-mapa');
  const pantallaCompleta = document.getElementById('pantalla-completa');
  const iframeContenido = document.getElementById('iframe-contenido');
  const cerrarPantalla = document.getElementById('cerrar-pantalla');
  const modalTerminos = document.getElementById('modal-terminos');
  const btnAceptarTerminos = document.getElementById('btn-aceptar-terminos');
  const btnPruebaCasa = document.getElementById('btn-prueba-casa');

  let pruebaCasaActivo = false;

  // Mostrar términos y condiciones si no aceptado
  function checkTerminos() {
    if (!localStorage.getItem('terminos_aceptados')) {
      modalTerminos.style.display = 'flex';
      document.body.classList.add('no-interactivo');
    }
  }
  checkTerminos();

  btnAceptarTerminos.addEventListener('click', () => {
    localStorage.setItem('terminos_aceptados', 'true');
    modalTerminos.style.display = 'none';
    document.body.classList.remove('no-interactivo');
  });

  // Toggle prueba casa
  btnPruebaCasa.addEventListener('click', () => {
    pruebaCasaActivo = !pruebaCasaActivo;
    btnPruebaCasa.textContent = pruebaCasaActivo ? 'Prueba Casa ON' : 'Prueba Casa OFF';
    btnPruebaCasa.style.backgroundColor = pruebaCasaActivo ? '#388e3c' : '#d32f2f';
    // Aquí se puede emitir evento o flag global para que las subpáginas hijas lean el estado y simulen gps
    window.pruebaCasaActivo = pruebaCasaActivo;
    console.log("Prueba Casa está", pruebaCasaActivo ? "ACTIVADO" : "DESACTIVADO");
  });

  // Función para cerrar todos los submenús
  function cerrarSubmenus() {
    submenuHamburguesa.style.display = 'none';
    submenuTresPuntos.style.display = 'none';
    submenuMapa.style.display = 'none';
  }

  // Alternar submenús
  btnHamburguesa.addEventListener('click', () => {
    if (submenuHamburguesa.style.display === 'flex') {
      submenuHamburguesa.style.display = 'none';
    } else {
      cerrarSubmenus();
      submenuHamburguesa.style.display = 'flex';
    }
  });
  btnTresPuntos.addEventListener('click', () => {
    if (submenuTresPuntos.style.display === 'flex') {
      submenuTresPuntos.style.display = 'none';
    } else {
      cerrarSubmenus();
      submenuTresPuntos.style.display = 'flex';
    }
  });
  btnMapa.addEventListener('click', () => {
    if (submenuMapa.style.display === 'flex') {
      submenuMapa.style.display = 'none';
    } else {
      cerrarSubmenus();
      submenuMapa.style.display = 'flex';
    }
  });

  // Abrir iframe al pulsar botón submenu
  function abrirIframe(url) {
    cerrarSubmenus();
    iframeContenido.src = ''; // reset para recargar si mismo
    iframeContenido.src = url;
    pantallaCompleta.style.display = 'flex';
    document.body.classList.add('no-interactivo');
    // Aquí puedes añadir código para pausar audios, gps, etc
  }
  // Añadir evento click en todos los botones de submenús
  document.querySelectorAll('.submenu button').forEach(btn => {
    btn.addEventListener('click', () => abrirIframe(btn.getAttribute('data-url')));
  });

  // Cerrar iframe
  cerrarPantalla.addEventListener('click', () => {
    pantallaCompleta.style.display = 'none';
    iframeContenido.src = '';
    document.body.classList.remove('no-interactivo');
    // Aquí puedes reactivar audios, gps, etc
  });

  // Cerrar submenús si clic fuera
  document.body.addEventListener('click', e => {
    if (!e.target.closest('.boton-flotante') && !e.target.closest('.submenu')) {
      cerrarSubmenus();
    }
  });

  // Configuración inicial prueba casa
  pruebaCasaActivo = false;
  window.pruebaCasaActivo = pruebaCasaActivo;

  // Centrar iframe mapa en Valencia si se abre mapa (ejemplo con Google Maps)
  iframeContenido.addEventListener('load', () => {
    // Aquí podrías comunicarte con la página hija para centrar, pausar, etc.
  });

</script>

</body>
</html>
