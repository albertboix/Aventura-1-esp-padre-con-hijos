hamburguesaBtn.addEventListener('click', () => {
  cerrarTodo();
  panelHamburguesa.classList.add('visible');
  panelHamburguesa.setAttribute('aria-hidden', 'false');
});

tresPuntosBtn.addEventListener('click', () => {
  cerrarTodo();
  panelTresPuntos.classList.add('visible');
  panelTresPuntos.setAttribute('aria-hidden', 'false');
});

btnTierra.addEventListener('click', () => {
  cerrarTodo();
  menuTierra.classList.add('visible');
  menuTierraVisible = true;
});

document.querySelectorAll('.cerrar-panel').forEach(btn => {
  btn.addEventListener('click', cerrarTodo);
});

// Funciones del menÃº tierra
menuTierra.querySelectorAll('button').forEach(btn => {
  btn.addEventListener('click', e => {
    const action = e.currentTarget.dataset.action;
    if (action === 'mostrar_siguiente') {
      document.getElementById('hijo').contentWindow.mostrarSiguientePunto();
    } else if (action === 'mostrar_ruta') {
      document.getElementById('hijo').contentWindow.mostrarRutaCompleta();
    } else if (action === 'mostrar_imagen') {
      imagenFull.classList.add('visible');
      if (screen.orientation?.lock) {
        screen.orientation.lock('landscape').catch(() => {});
      }
    }
  });
});

gpsBtn.addEventListener('click', () => {
  const estaON = gpsBtn.style.background === 'green';
  if (estaON) {
    gpsBtn.textContent = 'Modo casa OFF';
    gpsBtn.style.background = 'red';
    document.getElementById('hijo').contentWindow.activarGPS();
  } else {
    gpsBtn.textContent = 'Modo casa ON';
    gpsBtn.style.background = 'green';
    document.getElementById('hijo').contentWindow.desactivarGPS();
  }
});

// Abrir enlaces en iframe
document.querySelectorAll('.panel-flotante li[data-url]').forEach(el => {
  el.addEventListener('click', () => {
    const url = el.dataset.url;
    document.getElementById('hijo').src = url;
    cerrarTodo();
  });
});
